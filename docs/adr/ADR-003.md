# ADR-003 â€” Parsing strategy and normalization model

**Status:** Accepted
**Date:** 2026-02-20

## Context

We need consistent output regardless of input type (script vs compiled vs existing artifacts). PowerShell help has multiple shapes (comment blocks, XML docs, MAML).

### Decision

Create an internal **normalized help model** (single object graph) representing:

* Module metadata (name, GUID, version, cultures, URIs)
* Command metadata (name, verb-noun, synopsis/description)
* Parameters (name, type, required, pipeline, position, description)
* Examples
* Inputs/Outputs
* Links/notes

All generators (MAML, HelpInfo.xml, Markdown) consume the normalized model.

Parsing:

* Script functions: use **PowerShell AST** to locate functions and attach preceding/help blocks.
* Compiled cmdlets: reflect cmdlet metadata from assembly; hydrate descriptions from XML docs where available.
* MAML ingestion: map MAML nodes back into normalized model.

### Consequences

* Output consistency becomes testable with golden fixtures.
* We can add new input types without rewriting generators.
