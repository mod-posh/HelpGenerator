# ADR-014: Governance and Branch Protection Policy

## Status

Accepted

## Context

HelpGenerator is governed by Architecture Decision Records (ADRs) that define scope, output contracts, and behavioral constraints.

To ensure these architectural contracts remain enforceable and to prevent drift, governance must be enforced at the repository level through:

- Branch protection
- Required status checks
- Code Owner review
- Controlled release triggers

Without enforcement, ADR compliance becomes optional rather than structural.

This ADR formalizes the repository governance model.

---

## Decision

### 1. Protected `main` Branch

The `main` branch represents the releasable state of HelpGenerator.

The following protections are required:

- Direct pushes are prohibited
- Pull requests are required for all changes
- At least one approval is required
- Code Owner review is required
- Required status checks must pass
- Branch must be up-to-date before merge
- Force pushes and deletions are disabled

---

### 2. Milestone-Based Development

Development occurs on milestone branches:

```bash

milestone/<version>

```

Example:

```bash

milestone/0.0.0

```

Milestone branches may receive multiple pull requests.

When milestone work is complete:

1. The milestone branch is merged into `main`
2. The milestone is closed
3. Closing the milestone triggers the release workflow

---

### 3. Release Guardrail

The release workflow must validate:

- The milestone title matches the version defined in `Directory.Build.props`

If they do not match, the release workflow must fail.

This prevents accidental releases triggered by prematurely closing a milestone.

---

### 4. Hotfix Model

Hotfixes branch from `main`:

```bash

hotfix/<version-or-description>

```

After fix:

1. Pull request into `main`
2. Patch release is created
3. Fix is backported into active milestone branch if necessary

---

### 5. Documentation Automation

Post-release documentation updates must not push directly to `main`.

Documentation updates are handled via:

- A workflow triggered after successful release
- A generated pull request into `main`

This preserves branch protection integrity.

---

## Consequences

### Positive

- Prevents architectural drift
- Ensures ADR contracts are enforced structurally
- Reduces accidental releases
- Makes release automation deterministic
- Establishes professional governance standards

### Trade-offs

- Slightly more ceremony for merging changes
- Requires discipline in milestone management
- Requires branch protection configuration in GitHub UI

These trade-offs are intentional and align with project goals.

---

## Alternatives Considered

### Tag-driven releases only

Rejected because milestone-close release aligns better with issue-grouped release notes and project board workflow.

### No branch protection

Rejected because it makes ADR compliance unenforceable.

---

## References

- ADR-001 (Project Scope)
- ADR-004 (Repository Layout)
- ADR-013 (Testing Strategy)
