# ADR-002 — Source-of-truth and supported inputs

**Status:** Accepted
**Date:** 2026-02-20

## Context

Help content can come from:

* Script functions/modules (comment-based help)
* Compiled cmdlets (C#) where content often originates from XML docs or embedded MAML
* Existing help artifacts (MAML, HelpInfo.xml, CABs)

### Decision

We support these primary inputs:

**Script-based.**

* `.ps1` and `.psm1` containing functions/advanced functions
* Associated `.psd1` module manifest when provided (preferred for metadata)

**Compiled cmdlets.**

* `.dll` (PowerShell module assembly)
* Optional `.xml` documentation file emitted by build (recommended)
* Optional embedded resources if we define them (future-friendly)

**Artifact-based.**

* `HelpInfo.xml`
* MAML XML help files
* CAB files containing MAML help payloads

Source-of-truth hierarchy:

1. If input is **comment-based help**: that is the authoritative content for command help.
2. If input is **compiled cmdlets**: the authoritative content is the **XML docs** (preferred) or existing MAML.
3. HelpInfo.xml is authoritative for updatable metadata (cultures, versions, URIs), never for per-command content.

### Consequences

* Script path: Comment-help → normalized model → MAML + markdown (+ HelpInfo.xml metadata).
* Compiled path: XML docs/assembly metadata → normalized model → MAML + markdown (+ HelpInfo.xml metadata).
* Artifact path: MAML/HelpInfo.xml → markdown (+ validation).
