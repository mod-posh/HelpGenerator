# ADR-011 â€” Markdown Generation Contract

**Status:** Accepted
**Date:** 2026-02-20

---

## Context

The Help Generator suite must convert:

* NormalizedHelpModel
* MAML
* HelpInfo.xml

into structured, readable Markdown documentation.

Markdown output must:

* Be deterministic
* Be CI-friendly
* Be readable in GitHub and similar renderers
* Not depend on a specific static site generator
* Avoid hidden rendering assumptions
* Avoid "style drift"

This ADR defines the canonical Markdown output contract.

---

## 1. Markdown Philosophy

Markdown output is:

* Structural, not decorative
* Predictable, not clever
* Clean, not over-styled
* Portable across renderers
* Free of custom extensions

We do **not**:

* Inject front matter by default
* Assume Jekyll/Docusaurus/Hugo
* Inject HTML
* Auto-generate badges
* Infer links beyond defined related links

---

## 2. Directory Structure

Markdown output must follow ADR-004 layout:

```bash
/docs
  /module
    module.md
    helpinfo.md
  /commands
    <CommandName>.md
  /about
    <AboutTopic>.md (optional)
```

All filenames:

* Exact command name
* No spaces
* Case preserved
* Deterministic ordering

---

## 3. Command Markdown Structure

Each `<CommandName>.md` file must follow this exact section order:

```bash
# CommandName

## Synopsis

## Description

## Syntax

## Parameters

## Inputs

## Outputs

## Examples

## Notes

## Related Links
```

Sections may be omitted if no data exists, except:

* `# CommandName` (always present)
* `## Synopsis` (always present)
* `## Syntax` (always present)
* `## Parameters` (always present)

---

## 4. Header Rules

Top-level header:

```bash
# Get-Example
```

No module prefix.
No extra text.
No trailing metadata in header.

---

## 5. Synopsis Section

```bash
## Synopsis

Short single-paragraph summary.
```

Rules:

* Single paragraph.
* No bold formatting.
* No trailing punctuation enforcement.

---

## 6. Description Section

```bash
## Description

Paragraph one.

Paragraph two.
```

Rules:

* Paragraph breaks preserved.
* No forced line wrapping.
* No HTML.

---

$# 7. Syntax Section

Syntax is rendered as fenced code blocks.

For single parameter set:

````markdown
## Syntax

```powershell
Get-Example -Id <String> [-Verbose]
```
````

For multiple parameter sets:

````markdown
## Syntax

### ById

```powershell
Get-Example -Id <String>
```

### ByName

```powershell
Get-Example -Name <String>
```
````

Rules:

* Parameter sets sorted alphabetically.
* Default set appears first.
* Parameters rendered in deterministic order.
* Switch parameters shown without `<Type>` placeholder.
* Optional parameters wrapped in brackets.

---

$# 8. Parameters Section

Each parameter rendered as:

```bash
### -Id

Type: `String`
Required: Yes
Position: 0
Pipeline Input: ByValue

Specifies the identifier.
```

Rules:

* Parameter sections sorted alphabetically.
* Type shown inline as backticked.
* Boolean values shown as Yes/No.
* Blank metadata lines omitted.
* Description rendered as paragraph after metadata block.

No parameter tables (tables introduce formatting drift and poor diffing).

---

## 9. Inputs Section

```bash
## Inputs

### System.String

Description text.
```

If no description:

```bash
## Inputs

System.String
```

---

## 10. Outputs Section

```bash
## Outputs

### System.String

Returns a string.
```

---

## 11. Examples Section

Each example rendered as:

````markdown
## Examples

### Example 1

```powershell
Get-Example -Id 1
```

Retrieves example with ID 1.
````

Rules:

* Examples remain in original order.
* Code block language always `powershell`.
* Title auto-generated if absent.
* No additional formatting.

---

## 12. Notes Section

Only rendered if content exists.

Used for:

* Notes
* Special behaviors
* Remarks not appropriate for description

---

## 13. Related Links Section

```bash
## Related Links

- [About Examples](https://example.com)
```

Rules:

* Sorted alphabetically by link text.
* Standard Markdown link syntax only.

---

## 14. Module-Level Markdown

`module.md`:

```bash
# ModuleName

## Overview

Module description.

## Commands

- [Get-Example](../commands/Get-Example.md)
- [Set-Example](../commands/Set-Example.md)

## Updating Help

Instructions about Update-Help and HelpContentUri.
```

Rules:

* Command list sorted alphabetically.
* Relative links only.

---

## 15. HelpInfo Markdown (`helpinfo.md`)

Rendered as structured explanation:

```bash
# HelpInfo Metadata

## Help Content URI

https://example.com/help

## Supported Cultures

- en-US (1.0.0.0)
- fr-FR (1.0.0.0)
```

No raw XML embedded unless explicitly requested.

---

## 16. Determinism Rules

Must be deterministic:

* Section ordering
* Parameter ordering
* Parameter set ordering
* Culture ordering
* Bullet ordering
* Line endings (LF)
* Indentation (2 spaces)
* No trailing whitespace

Golden fixture tests must pass exact text comparison.

---

## 17. Guardrails

Markdown generator must not:

* Reword descriptions
* Auto-link parameter names
* Insert emojis
* Add badges
* Inject front matter
* Change casing
* Wrap lines arbitrarily
* Inject site-specific anchors

It is a structural renderer only.

---

## 18. Strict Mode Option (Future)

Optional flag:

```bash
-StrictMarkdown
```

Enforces:

* No empty sections
* No placeholder prose
* Examples required
* Output types required

Strict mode converts certain warnings into errors.

---

## Rationale

This structure:

* Mirrors PowerShell help mental model
* Avoids rendering surprises
* Works cleanly in GitHub
* Diff-friendly in PRs
* Easy to test
* Human-readable without tooling

---

## Consequences

Positive:

* Stable, predictable docs
* Easy CI enforcement
* Clean GitHub rendering
* Simple mental model

Trade-offs:

* No advanced site features
* No automatic navigation hierarchy
* No dynamic TOC injection
